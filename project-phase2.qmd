---
title: "DM Project"
author: "Louise Cazalet and Esteban Marianadin"
format: html
editor: visual
---

# Project Title

#### Louise Cazalet-Dance & Esteban Marianadin

**Link to our Github project :** https://github.com/esteban-mrnd/dm-project.git

### Links to the data sources

All the following links include the filters we used to get the data for our analysis.

- **Total and green patents** : https://data-explorer.oecd.org/vis?lc=en&tm=-%20regions&pg=0&snb=315&vw=tb&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_REG_PAT%40DF_PAT&df[ag]=OECD.CFE.EDS&df[vs]=1.0&dq=A.TL2....APPLICATION.PAT.._T%2BENV.PATN&pd=1995%2C2022&to[TIME_PERIOD]=false

- **Wildfires** : https://data-explorer.oecd.org/vis?lc=en&tm=-%20regions&pg=0&snb=315&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_REG_CLIM%40DF_FIRES&df[ag]=OECD.CFE.EDS&df[vs]=2.4&dq=A.TL2...FIRE.....PT_AR&pd=2000%2C2023&to[TIME_PERIOD]=false&vw=tb

- **Heat stress** :  https://data-explorer.oecd.org/vis?lc=en&tm=-%20regions&pg=20&snb=315&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_REG_ECO%40DF_GDP&df[ag]=OECD.CFE.EDS&df[vs]=2.0&dq=A.TL2...GDP..Q.USD_PPP_PS&pd=1995%2C2023&to[TIME_PERIOD]=false

- **GDP per capita per regions** : https://data-explorer.oecd.org/vis?lc=en&tm=-%20regions&pg=20&snb=315&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_REG_ECO%40DF_GDP&df[ag]=OECD.CFE.EDS&df[vs]=2.0&dq=A.TL2...GDP..Q.USD_PPP_PS&pd=1995%2C2023&to[TIME_PERIOD]=false

- **Health risks** : https://data-explorer.oecd.org/vis?lc=en&tm=regions&pg=20&snb=315&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_REG_HEALTH%40DF_RISK&df[ag]=OECD.CFE.EDS&df[vs]=2.0&dq=A....PM25_POP_EXP...&to[TIME_PERIOD]=false&pd=1995%2C2020

- **GDP** : https://data.worldbank.org/indicator/NY.GDP.MKTP.CD

- **R&D expenditures** : https://data.worldbank.org/indicator/GB.XPD.RSDV.GD.ZS

### Description of the sources (?)

on peut réorganiser pour faire variable par variable ?

### Short description of the project

### Data Import

```{r}
library(vroom)
library(here)
library(dplyr)
library(tidyr)
library
here::i_am("dm-project.Rproj")
```

```{r}
patents <- vroom(here("data","patents.csv"))
gdp_regions <- vroom(here("data","gdp_regions.csv"))
precipitation <- vroom(here("data","extreme_precipitations.csv"))
health_risks <- vroom(here("data","health_risks.csv"))
heat_stress <- vroom(here("data","heat_stress.csv"))
wildfires <- vroom(here("data","wildfires.csv"))
rd_exp_country <- vroom(here("data","rd-exp-country.csv"))

```

### Data description

```{r}
summarize_data <- function(df) {
  df |> summarize(
    `Number of lines` = n(),
    `Number of columns` = ncol(df),
    start_year = min(df[["TIME_PERIOD"]], na.rm = TRUE),
    end_year   = max(df[["TIME_PERIOD"]], na.rm = TRUE)
  )
}


summarize_data(patents)
summarize_data(gdp_regions)
summarize_data(precipitation)
summarize_data(health_risks)
summarize_data(heat_stress)
summarize_data(wildfires)
```

### Key Variable : share of green patent

#### Clean patents and create final database

```{r}
df <- patents |>
  select(REF_AREA,`Zone de référence`, TIME_PERIOD, COUNTRY, Pays, OBS_VALUE, `Sélection de domaines technologiques de l'OCDE`)


df <- df|>
  pivot_wider(
    names_from = `Sélection de domaines technologiques de l'OCDE`,
    values_from = OBS_VALUE
  )

df <- df |>
  rename(
    green_patents = `Technologies liées à l'environment`,
    total_patents = `Total des brevets`
  )

df<- df |>
  left_join(
    gdp_regions |> select(REF_AREA, TIME_PERIOD, OBS_VALUE),
    by = c("REF_AREA", "TIME_PERIOD")
  ) |>
  rename(gdp_region=OBS_VALUE)

df<- df |>
  left_join(
    health_risks|> select(REF_AREA, TIME_PERIOD, OBS_VALUE),
    by = c("REF_AREA", "TIME_PERIOD")
  ) |>
  rename(pollution_expos=OBS_VALUE)

df<- df |>
  left_join(
    heat_stress|> select(REF_AREA, TIME_PERIOD, OBS_VALUE),
    by = c("REF_AREA", "TIME_PERIOD")
  ) |>
  rename(heat_stress=OBS_VALUE)

df<- df |>
  left_join(
    precipitation|> select(REF_AREA, TIME_PERIOD, OBS_VALUE),
    by = c("REF_AREA", "TIME_PERIOD")
  ) |>
  rename(precipitation=OBS_VALUE)

df<- df |>
  left_join(
    wildfires|> select(REF_AREA, TIME_PERIOD, OBS_VALUE),
    by = c("REF_AREA", "TIME_PERIOD")
  ) |>
  rename(wildfire=OBS_VALUE)


```
